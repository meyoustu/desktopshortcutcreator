/// <summary>
/// Created at 2021/3/28 23:42.
/// @author Liangcheng Juves
/// </summary>

using System;
using System.Runtime.InteropServices;

namespace UnsafeNativeMethods
{
    /// <summary>IShellLink.GetPath fFlags: Flags that specify the type of path information to retrieve</summary>
    [Flags()]
    enum SLGP_FLAGS
    {
        /// <summary>Retrieves the standard short (8.3 format) file name</summary>
        SLGP_SHORTPATH = 0x1,
        /// <summary>Retrieves the Universal Naming Convention (UNC) path name of the file</summary>
        SLGP_UNCPRIORITY = 0x2,
        /// <summary>Retrieves the raw path name. A raw path is something that might not exist and may include environment variables that need to be expanded</summary>
        SLGP_RAWPATH = 0x4
    }

    /// <summary>IShellLink.Resolve fFlags</summary>
    [Flags()]
    enum SLR_FLAGS
    {
        /// <summary>
        /// Do not display a dialog box if the link cannot be resolved. When SLR_NO_UI is set,
        /// the high-order word of fFlags can be set to a time-out value that specifies the
        /// maximum amount of time to be spent resolving the link. The function returns if the
        /// link cannot be resolved within the time-out duration. If the high-order word is set
        /// to zero, the time-out duration will be set to the default value of 3,000 milliseconds
        /// (3 seconds). To specify a value, set the high word of fFlags to the desired time-out
        /// duration, in milliseconds.
        /// </summary>
        SLR_NO_UI = 0x1,
        /// <summary>Obsolete and no longer used</summary>
        SLR_ANY_MATCH = 0x2,
        /// <summary>If the link object has changed, update its path and list of identifiers.
        /// If SLR_UPDATE is set, you do not need to call IPersistFile::IsDirty to determine
        /// whether or not the link object has changed.</summary>
        SLR_UPDATE = 0x4,
        /// <summary>Do not update the link information</summary>
        SLR_NOUPDATE = 0x8,
        /// <summary>Do not execute the search heuristics</summary>
        SLR_NOSEARCH = 0x10,
        /// <summary>Do not use distributed link tracking</summary>
        SLR_NOTRACK = 0x20,
        /// <summary>Disable distributed link tracking. By default, distributed link tracking tracks
        /// removable media across multiple devices based on the volume name. It also uses the
        /// Universal Naming Convention (UNC) path to track remote file systems whose drive letter
        /// has changed. Setting SLR_NOLINKINFO disables both types of tracking.</summary>
        SLR_NOLINKINFO = 0x40,
        /// <summary>Call the Microsoft Windows Installer</summary>
        SLR_INVOKE_MSI = 0x80
    }

    // The CharSet must match the CharSet of the corresponding PInvoke signature
    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    /* _WIN32_FIND_DATAW */
    struct WIN32_FIND_DATAW
    {
        /* DWORD    dwFileAttributes; */
        public uint dwFileAttributes;
        /* FILETIME ftCreationTime; */
        public System.Runtime.InteropServices.ComTypes.FILETIME ftCreationTime;
        /* FILETIME ftLastAccessTime; */
        public System.Runtime.InteropServices.ComTypes.FILETIME ftLastAccessTime;
        /* FILETIME ftLastWriteTime; */
        public System.Runtime.InteropServices.ComTypes.FILETIME ftLastWriteTime;
        /* DWORD    nFileSizeHigh; */
        public uint nFileSizeHigh;
        /* DWORD    nFileSizeLow; */
        public uint nFileSizeLow;
        /* DWORD    dwReserved0; */
        public uint dwReserved0;
        /* DWORD    dwReserved1; */
        public uint dwReserved1;
        /* WCHAR    cFileName[MAX_PATH]; */
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 260)]
        public string cFileName;
        /* WCHAR    cAlternateFileName[14]; */
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 14)]
        public string cAlternateFileName;
        /* DWORD    dwFileType; */
        public uint dwFileType;
        /* DWORD    dwCreatorType; */
        public uint dwCreatorType;
        /* WORD     wFinderFlags; */
        public int wFinderFlags;
    }
}